!function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(e,n,t){return e(t={path:n,exports:{},require:function(e,n){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==n&&t.path)}},t.exports),t.exports}var t,r=n((function(n,t){n.exports=function(){var n={VERSION:"0.8.0",not:{},all:{},any:{}},t=Object.prototype.toString,r=Array.prototype.slice,o=Object.prototype.hasOwnProperty;function i(e){return function(){return!e.apply(null,r.call(arguments))}}function a(e){return function(){for(var n=d(arguments),t=n.length,r=0;r<t;r++)if(!e.call(null,n[r]))return!1;return!0}}function u(e){return function(){for(var n=d(arguments),t=n.length,r=0;r<t;r++)if(e.call(null,n[r]))return!0;return!1}}var s={"<":function(e,n){return e<n},"<=":function(e,n){return e<=n},">":function(e,n){return e>n},">=":function(e,n){return e>=n}};function c(e,n){var t=n+"",r=+(t.match(/\d+/)||NaN),o=t.match(/^[<>]=?|/)[0];return s[o]?s[o](e,r):e==r||r!=r}function d(e){var t=r.call(e);return 1===t.length&&n.array(t[0])&&(t=t[0]),t}n.arguments=function(e){return"[object Arguments]"===t.call(e)||null!=e&&"object"==typeof e&&"callee"in e},n.array=Array.isArray||function(e){return"[object Array]"===t.call(e)},n.boolean=function(e){return!0===e||!1===e||"[object Boolean]"===t.call(e)},n.char=function(e){return n.string(e)&&1===e.length},n.date=function(e){return"[object Date]"===t.call(e)},n.domNode=function(e){return n.object(e)&&e.nodeType>0},n.error=function(e){return"[object Error]"===t.call(e)},n.function=function(e){return"[object Function]"===t.call(e)||"function"==typeof e},n.json=function(e){return"[object Object]"===t.call(e)},n.nan=function(e){return e!=e},n.null=function(e){return null===e},n.number=function(e){return n.not.nan(e)&&"[object Number]"===t.call(e)},n.object=function(e){return Object(e)===e},n.regexp=function(e){return"[object RegExp]"===t.call(e)},n.sameType=function(e,r){var o=t.call(e);return o===t.call(r)&&("[object Number]"!==o||!n.any.nan(e,r)||n.all.nan(e,r))},n.sameType.api=["not"],n.string=function(e){return"[object String]"===t.call(e)},n.undefined=function(e){return void 0===e},n.windowObject=function(e){return null!=e&&"object"==typeof e&&"setInterval"in e},n.empty=function(e){if(n.object(e)){var t=Object.getOwnPropertyNames(e).length;return!!(0===t||1===t&&n.array(e)||2===t&&n.arguments(e))}return""===e},n.existy=function(e){return null!=e},n.falsy=function(e){return!e},n.truthy=i(n.falsy),n.above=function(e,t){return n.all.number(e,t)&&e>t},n.above.api=["not"],n.decimal=function(e){return n.number(e)&&e%1!=0},n.equal=function(e,t){return n.all.number(e,t)?e===t&&1/e==1/t:n.all.string(e,t)||n.all.regexp(e,t)?""+e==""+t:!!n.all.boolean(e,t)&&e===t},n.equal.api=["not"],n.even=function(e){return n.number(e)&&e%2==0},n.finite=isFinite||function(e){return n.not.infinite(e)&&n.not.nan(e)},n.infinite=function(e){return e===1/0||e===-1/0},n.integer=function(e){return n.number(e)&&e%1==0},n.negative=function(e){return n.number(e)&&e<0},n.odd=function(e){return n.number(e)&&e%2==1},n.positive=function(e){return n.number(e)&&e>0},n.under=function(e,t){return n.all.number(e,t)&&e<t},n.under.api=["not"],n.within=function(e,t,r){return n.all.number(e,t,r)&&e>t&&e<r},n.within.api=["not"];var l={affirmative:/^(?:1|t(?:rue)?|y(?:es)?|ok(?:ay)?)$/,alphaNumeric:/^[A-Za-z0-9]+$/,caPostalCode:/^(?!.*[DFIOQU])[A-VXY][0-9][A-Z]\s?[0-9][A-Z][0-9]$/,creditCard:/^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/,dateString:/^(1[0-2]|0?[1-9])([\/-])(3[01]|[12][0-9]|0?[1-9])(?:\2)(?:[0-9]{2})?[0-9]{2}$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,eppPhone:/^\+[0-9]{1,3}\.[0-9]{4,14}(?:x.+)?$/,hexadecimal:/^(?:0x)?[0-9a-fA-F]+$/,hexColor:/^#?([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/,ipv4:/^(?:(?:\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])\.){3}(?:\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])$/,ipv6:/^((?=.*::)(?!.*::.+::)(::)?([\dA-F]{1,4}:(:|\b)|){5}|([\dA-F]{1,4}:){6})((([\dA-F]{1,4}((?!\3)::|:\b|$))|(?!\2\3)){2}|(((2[0-4]|1\d|[1-9])?\d|25[0-5])\.?\b){4})$/i,nanpPhone:/^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/,socialSecurityNumber:/^(?!000|666)[0-8][0-9]{2}-?(?!00)[0-9]{2}-?(?!0000)[0-9]{4}$/,timeString:/^(2[0-3]|[01]?[0-9]):([0-5]?[0-9]):([0-5]?[0-9])$/,ukPostCode:/^[A-Z]{1,2}[0-9RCHNQ][0-9A-Z]?\s?[0-9][ABD-HJLNP-UW-Z]{2}$|^[A-Z]{2}-?[0-9]{4}$/,url:/^(?:(?:https?|ftp):\/\/)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/\S*)?$/i,usZipCode:/^[0-9]{5}(?:-[0-9]{4})?$/};function f(e,t){n[e]=function(n){return t[e].test(n)}}for(var p in l)l.hasOwnProperty(p)&&f(p,l);n.ip=function(e){return n.ipv4(e)||n.ipv6(e)},n.capitalized=function(e){if(n.not.string(e))return!1;for(var t=e.split(" "),r=0;r<t.length;r++){var o=t[r];if(o.length){var i=o.charAt(0);if(i!==i.toUpperCase())return!1}}return!0},n.endWith=function(e,t){if(n.not.string(e))return!1;t+="";var r=e.length-t.length;return r>=0&&e.indexOf(t,r)===r},n.endWith.api=["not"],n.include=function(e,n){return e.indexOf(n)>-1},n.include.api=["not"],n.lowerCase=function(e){return n.string(e)&&e===e.toLowerCase()},n.palindrome=function(e){if(n.not.string(e))return!1;for(var t=(e=e.replace(/[^a-zA-Z0-9]+/g,"").toLowerCase()).length-1,r=0,o=Math.floor(t/2);r<=o;r++)if(e.charAt(r)!==e.charAt(t-r))return!1;return!0},n.space=function(e){if(n.not.char(e))return!1;var t=e.charCodeAt(0);return t>8&&t<14||32===t},n.startWith=function(e,t){return n.string(e)&&0===e.indexOf(t)},n.startWith.api=["not"],n.upperCase=function(e){return n.string(e)&&e===e.toUpperCase()};var g=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],h=["january","february","march","april","may","june","july","august","september","october","november","december"];n.day=function(e,t){return n.date(e)&&t.toLowerCase()===g[e.getDay()]},n.day.api=["not"],n.dayLightSavingTime=function(e){var n=new Date(e.getFullYear(),0,1),t=new Date(e.getFullYear(),6,1),r=Math.max(n.getTimezoneOffset(),t.getTimezoneOffset());return e.getTimezoneOffset()<r},n.future=function(e){var t=new Date;return n.date(e)&&e.getTime()>t.getTime()},n.inDateRange=function(e,t,r){if(n.not.date(e)||n.not.date(t)||n.not.date(r))return!1;var o=e.getTime();return o>t.getTime()&&o<r.getTime()},n.inDateRange.api=["not"],n.inLastMonth=function(e){return n.inDateRange(e,new Date((new Date).setMonth((new Date).getMonth()-1)),new Date)},n.inLastWeek=function(e){return n.inDateRange(e,new Date((new Date).setDate((new Date).getDate()-7)),new Date)},n.inLastYear=function(e){return n.inDateRange(e,new Date((new Date).setFullYear((new Date).getFullYear()-1)),new Date)},n.inNextMonth=function(e){return n.inDateRange(e,new Date,new Date((new Date).setMonth((new Date).getMonth()+1)))},n.inNextWeek=function(e){return n.inDateRange(e,new Date,new Date((new Date).setDate((new Date).getDate()+7)))},n.inNextYear=function(e){return n.inDateRange(e,new Date,new Date((new Date).setFullYear((new Date).getFullYear()+1)))},n.leapYear=function(e){return n.number(e)&&(e%4==0&&e%100!=0||e%400==0)},n.month=function(e,t){return n.date(e)&&t.toLowerCase()===h[e.getMonth()]},n.month.api=["not"],n.past=function(e){var t=new Date;return n.date(e)&&e.getTime()<t.getTime()},n.quarterOfYear=function(e,t){return n.date(e)&&n.number(t)&&t===Math.floor((e.getMonth()+3)/3)},n.quarterOfYear.api=["not"],n.today=function(e){var t=(new Date).toDateString();return n.date(e)&&e.toDateString()===t},n.tomorrow=function(e){var t=new Date,r=new Date(t.setDate(t.getDate()+1)).toDateString();return n.date(e)&&e.toDateString()===r},n.weekend=function(e){return n.date(e)&&(6===e.getDay()||0===e.getDay())},n.weekday=i(n.weekend),n.year=function(e,t){return n.date(e)&&n.number(t)&&t===e.getFullYear()},n.year.api=["not"],n.yesterday=function(e){var t=new Date,r=new Date(t.setDate(t.getDate()-1)).toDateString();return n.date(e)&&e.toDateString()===r};var b=n.windowObject("object"==typeof e&&e)&&e,m=n.windowObject("object"==typeof self&&self)&&self,y=n.windowObject("object"==typeof this&&this)&&this,v=b||m||y||Function("return this")(),w=m&&m.document,D=v.is,E=m&&m.navigator,F=(E&&E.appVersion||"").toLowerCase(),I=(E&&E.userAgent||"").toLowerCase(),N=(E&&E.vendor||"").toLowerCase();function G(){var e=n;for(var t in e)if(o.call(e,t)&&n.function(e[t]))for(var r=e[t].api||["not","all","any"],s=0;s<r.length;s++)"not"===r[s]&&(n.not[t]=i(n[t])),"all"===r[s]&&(n.all[t]=a(n[t])),"any"===r[s]&&(n.any[t]=u(n[t]))}return n.android=function(){return/android/.test(I)},n.android.api=["not"],n.androidPhone=function(){return/android/.test(I)&&/mobile/.test(I)},n.androidPhone.api=["not"],n.androidTablet=function(){return/android/.test(I)&&!/mobile/.test(I)},n.androidTablet.api=["not"],n.blackberry=function(){return/blackberry/.test(I)||/bb10/.test(I)},n.blackberry.api=["not"],n.chrome=function(e){var n=/google inc/.test(N)?I.match(/(?:chrome|crios)\/(\d+)/):null;return null!==n&&c(n[1],e)},n.chrome.api=["not"],n.desktop=function(){return n.not.mobile()&&n.not.tablet()},n.desktop.api=["not"],n.edge=function(e){var n=I.match(/edge\/(\d+)/);return null!==n&&c(n[1],e)},n.edge.api=["not"],n.firefox=function(e){var n=I.match(/(?:firefox|fxios)\/(\d+)/);return null!==n&&c(n[1],e)},n.firefox.api=["not"],n.ie=function(e){var n=I.match(/(?:msie |trident.+?; rv:)(\d+)/);return null!==n&&c(n[1],e)},n.ie.api=["not"],n.ios=function(e){return n.iphone(e)||n.ipad(e)||n.ipod(e)},n.ios.api=["not"],n.ipad=function(e){var t=n.not.iphone()&&n.not.ipod()?I.match(/ipad.+?os (\d+)/)||(I.includes("mac")&&"ontouchend"in w?I.match(/version\/(\d+)/):null):null;return null!==t&&c(t[1],e)},n.ipad.api=["not"],n.iphone=function(e){var n=I.match(/iphone(?:.+?os (\d+))?/);return null!==n&&c(n[1]||1,e)},n.iphone.api=["not"],n.ipod=function(e){var n=I.match(/ipod.+?os (\d+)/);return null!==n&&c(n[1],e)},n.ipod.api=["not"],n.linux=function(){return/linux/.test(F)},n.linux.api=["not"],n.mac=function(){return/mac/.test(F)},n.mac.api=["not"],n.mobile=function(){return n.iphone()||n.ipod()||n.androidPhone()||n.blackberry()||n.windowsPhone()},n.mobile.api=["not"],n.offline=i(n.online),n.offline.api=["not"],n.online=function(){return!E||!0===E.onLine},n.online.api=["not"],n.opera=function(e){var n=I.match(/(?:^opera.+?version|opr)\/(\d+)/);return null!==n&&c(n[1],e)},n.opera.api=["not"],n.phantom=function(e){var n=I.match(/phantomjs\/(\d+)/);return null!==n&&c(n[1],e)},n.phantom.api=["not"],n.safari=function(e){var n=I.match(/version\/(\d+).+?safari/);return null!==n&&c(n[1],e)},n.safari.api=["not"],n.tablet=function(){return n.ipad()||n.androidTablet()||n.windowsTablet()},n.tablet.api=["not"],n.touchDevice=function(){return!!w&&("ontouchstart"in m||"DocumentTouch"in m&&w instanceof DocumentTouch)},n.touchDevice.api=["not"],n.windows=function(){return/win/.test(F)},n.windows.api=["not"],n.windowsPhone=function(){return n.windows()&&/phone/.test(I)},n.windowsPhone.api=["not"],n.windowsTablet=function(){return n.windows()&&n.not.windowsPhone()&&/touch/.test(I)},n.windowsTablet.api=["not"],n.propertyCount=function(e,t){if(n.not.object(e)||n.not.number(t))return!1;var r=0;for(var i in e)if(o.call(e,i)&&++r>t)return!1;return r===t},n.propertyCount.api=["not"],n.propertyDefined=function(e,t){return n.object(e)&&n.string(t)&&t in e},n.propertyDefined.api=["not"],n.inArray=function(e,t){if(n.not.array(t))return!1;for(var r=0;r<t.length;r++)if(t[r]===e)return!0;return!1},n.inArray.api=["not"],n.sorted=function(e,t){if(n.not.array(e))return!1;for(var r=s[t]||s[">="],o=1;o<e.length;o++)if(!r(e[o],e[o-1]))return!1;return!0},G(),n.setNamespace=function(){return v.is=D,this},n.setRegexp=function(e,n){for(var t in l)o.call(l,t)&&n===t&&(l[t]=e)},n}()})),o={UNKNOWN:"unknown",GRANTED:"granted",DENIED:"denied"},i={isIFramed:window.self!==window.parent,isIOS13:r.ios(">=13"),hasGyro:r.not.desktop()&&!!window.DeviceOrientationEvent,hasPermissions:!!window.DeviceOrientationEvent&&"function"==typeof window.DeviceOrientationEvent.requestPermission,permissionStatus:o.UNKNOWN},a={UNKNOWN:"1",NOT_INITIALIZED:"2",NO_GYRO:"3",INITIALIZING:"4",REQUESTING:"5",ENABLING:"6",DISABLING:"7",STATUS_UNKNOWN:"8",STATUS_DENIED:"9"},u={READY:"ready",IDLE:"idle",INACTIVE:"inactive",FAILED:"failed",ERRORED:"errored",INITING:"initing",REQUESTING:"requesting",ENABLING:"enabling",ENABLED:"enabled",DISABLING:"disabling",DISABLED:"disabled"},s=n((function(e,n){var t;t=function(){function e(){for(var e=0,n={};e<arguments.length;e++){var t=arguments[e];for(var r in t)n[r]=t[r]}return n}function n(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function t(r){function o(){}function i(n,t,i){if("undefined"!=typeof document){"number"==typeof(i=e({path:"/"},o.defaults,i)).expires&&(i.expires=new Date(1*new Date+864e5*i.expires)),i.expires=i.expires?i.expires.toUTCString():"";try{var a=JSON.stringify(t);/^[\{\[]/.test(a)&&(t=a)}catch(e){}t=r.write?r.write(t,n):encodeURIComponent(String(t)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),n=encodeURIComponent(String(n)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var u="";for(var s in i)i[s]&&(u+="; "+s,!0!==i[s]&&(u+="="+i[s].split(";")[0]));return document.cookie=n+"="+t+u}}function a(e,t){if("undefined"!=typeof document){for(var o={},i=document.cookie?document.cookie.split("; "):[],a=0;a<i.length;a++){var u=i[a].split("="),s=u.slice(1).join("=");t||'"'!==s.charAt(0)||(s=s.slice(1,-1));try{var c=n(u[0]);if(s=(r.read||r)(s,c)||n(s),t)try{s=JSON.parse(s)}catch(e){}if(o[c]=s,e===c)break}catch(e){}}return e?o[e]:o}}return o.set=i,o.get=function(e){return a(e,!1)},o.getJSON=function(e){return a(e,!0)},o.remove=function(n,t){i(n,"",e(t,{expires:-1}))},o.defaults={},o.withConverter=t,o}((function(){}))},e.exports=t()})),c=function(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,t=String(e);t.length<n;)t="0"+t;return t},d=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{h:n?c(e.getHours()):e.getHours(),m:n?c(e.getMinutes()):e.getMinutes(),s:n?c(e.getSeconds()):e.getSeconds(),ms:n?c(e.getMilliseconds(),3):e.getMilliseconds()}},l=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=d(e,!0),r=t.h,o=t.m,i=t.s,a=t.ms;return"".concat(r,":").concat(o,":").concat(i)+(n?".".concat(a):"")},f={NONE:0,ERROR:1,WARN:2,INFO:3,DEBUG:4},p="csi-log-level",g=s.get(p)||f.ERROR,h=(t=console.log,function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];r.unshift("".concat(e)),r.unshift("[".concat(l(new Date),"]")),t.apply(console,r)}),b=function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];m(e)<=g&&h.apply(this,t)},m=function(e){return("string"==typeof e?f[e.toUpperCase()]:"number"==typeof e&&f.NONE<e&&e<=f.DEBUG?e:void 0)||f.NONE},y={Levels:f,level:function(){if(0===arguments.length)return g;g=m(arguments[0]),s.set(p,g)},_:b,out:b,error:function(){b.apply(this,[f.ERROR].concat(Array.prototype.slice.call(arguments)))},warn:function(){b.apply(this,[f.WARN].concat(Array.prototype.slice.call(arguments)))},info:function(){b.apply(this,[f.INFO].concat(Array.prototype.slice.call(arguments)))},debug:function(){b.apply(this,[f.DEBUG].concat(Array.prototype.slice.call(arguments)))}};window&&(window.concat=window.concat||{},window.concat.Log=window.concat.Log||y);var v,w,D,E,F,I,N,G,A,T,S=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)throw"`provider` is invalid";if(!n)throw"`message` is invalid";this.provider=e,this.message=n,this.data=t},L="gyro-handshake",R="gyro-enable",_="gyro-disable",x="gyro-handshook",O="gyro-enabled",C="gyro-disabled",k="gyro-motion",j="gyro-error",P=(v=void 0,w="",D=u.READY,E=function(){y.info("Gyro.parent","enable()"),y.debug("Gyro.parent","  state:",D);var e=function(){y.debug("Gyro.parent","enable(), __done(), enabling..."),D=u.ENABLED,window.addEventListener("deviceorientation",A),G(O)};switch(D){case u.READY:G(j,{error:a.NOT_INITIALIZED});break;case u.INACTIVE:G(j,{error:a.NO_GYRO});break;case u.INITING:G(j,{error:a.INITIALIZING});break;case u.REQUESTING:G(j,{error:a.REQUESTING});break;case u.ENABLED:G(O);break;case u.IDLE:if(y.debug("Gyro.parent","  library can be enabled..."),y.debug("Gyro.parent","  checking on permissions..."),y.debug("Gyro.parent","  hasPermissions:",i.hasPermissions),y.debug("Gyro.parent","  permissionStatus:",i.permissionStatus),!i.hasPermissions||i.permissionStatus===o.GRANTED)return void e();y.debug("Gyro.parent","  requesting..."),I().then((function(){switch(y.debug("Gyro.parent","enable(), _request.then()..."),y.debug("Gyro.parent","  permissionStatus:",i.permissionStatus),i.permissionStatus){case o.GRANTED:e();break;case o.DENIED:G(j,{error:a.STATUS_DENIED}),D=u.INACTIVE;break;default:G(j,{error:a.STATUS_UNKNOWN}),D=u.INACTIVE}}))}},F=function(){switch(y.info("Gyro.parent","disable()"),D){case u.READY:G(j,{error:a.NOT_INITIALIZED});break;case u.INACTIVE:G(j,{error:a.NO_GYRO});break;case u.INITING:G(j,{error:a.INITIALIZING});break;case u.REQUESTING:G(j,{error:a.REQUESTING});break;case u.IDLE:G(C);break;case u.ENABLED:y.debug("Gyro.parent","  can be disabled..."),y.debug("Gyro.parent","  disabling..."),window.removeEventListener("deviceorientation",A),G(C),D=u.IDLE,y.debug("Gyro.parent","  _state:",D),N=!0}},I=function(){return new Promise((function(e,n){y.info("Gyro.parent","_request()"),y.debug("Gyro.parent","  _state:",D);var t=D;D=u.REQUESTING,y.debug("Gyro.parent","  new _state:",D),DeviceMotionEvent.requestPermission().then((function(e){y.debug("Gyro.parent","_request(), requestPermission.then(), access:",e),i.permissionStatus=e,y.debug("Gyro.parent","  permissionStatus:",i.permissionStatus)})).catch((function(){y.debug("Gyro.parent","_request(), requestPermission.catch()")})).finally((function(){y.debug("Gyro.parent","_request(), requestPermission.finally()"),D=t,y.debug("Gyro.parent","  new _state:",D),e()}))}))},N=!0,G=function(e,n){var t=new S(w,e,n);e===k?(N&&y.debug("Gyro.parent","_pm(), payload:",t),N=!1):y.debug("Gyro.parent","_pm(), payload:",t),v&&v.contentWindow&&v.contentWindow.postMessage(t,"*")},A=function(e){var n={event:{alpha:e.alpha,beta:e.beta,gamma:e.gamma}};G(k,n)},T=function(e){var n=e.data;if(n.provider===w&&n.message)switch(y.info("Gyro.parent","_onMessage_fromChild(), p:",n),n.message){case L:G(x);break;case R:E();break;case _:F()}},{state:function(){return D},elem:function(){return v},init:function(e,n){if(y.info("Gyro.parent","init(), Called."),D!==u.READY)throw new Error("library has already been initialized.");D=u.INITING,v=e,w=n,y.debug("Gyro.parent","  _state:",D),y.debug("Gyro.parent","  _elem:",v),y.debug("Gyro.parent","  _provider:",w),y.debug("Gyro.parent","  adding 'message' listener..."),window.addEventListener("message",T),D=r.desktop()?u.INACTIVE:u.IDLE,y.debug("Gyro.parent","  _state:",D)},dispose:function(){y.info("Gyro.parent","dispose()"),y.debug("Gyro.parent","  _state:",D),window.removeEventListener("message",T),window.removeEventListener("deviceorientation",A),v=null,w="",D=u.READY},enable:E,disable:F}),U=function(){var e="",n=u.READY,t=function(){return new Promise((function(e,t){y.info("Gyro.child","_requestChild()"),y.debug("Gyro.child","  prev _state:",n);var r=n;n=u.REQUESTING,y.debug("Gyro.child","  now _state:",n),y.debug("Gyro.child","  permissionStatus:",i.permissionStatus),y.debug("Gyro.child","  requesting..."),DeviceMotionEvent.requestPermission().then((function(e){y.debug("GyroFrame.child","  requestPermission().then..."),i.permissionStatus=e})).catch((function(e){y.debug("GyroFrame.child","  requestPermission().catch... e:",e)})).finally((function(){y.debug("GyroFrame.child","  requestPermission().finally..."),n=r,e()}))}))},s=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.parent,r=new S(e,n);y.info("Gyro.child","_pm(), payload:",r),t.postMessage(r,"*")},c=!0,d=function(n){var t=n.data;if(t&&t.provider===e&&t.message===k){var r;try{(r=document.createEvent("DeviceOrientationEvent")).initDeviceOrientationEvent("deviceorientation",!0,!0,t.data.event.alpha,t.data.event.beta,t.data.event.gamma,!0),c&&y.debug("Gyro.child","_onMessage_motion(), (create) event:",r)}catch(n){r=new DeviceOrientationEvent("deviceorientation",{bubbles:!0,cancelable:!0,alpha:t.data.event.alpha,beta:t.data.event.beta,gamma:t.data.event.gamma}),c&&y.debug("Gyro.child","_onMessage_motion(), (constructor) event:",r)}c=!1,window.dispatchEvent(r)}},l=function(){return new Promise((function(n,t){var r=setTimeout((function(){y.debug("  no handshake received"),window.removeEventListener("message",o),t()}),3e3),o=function t(o){var i=o.data;y.debug("Gyro.child","__onMessage_handshake__(), payload:",i),i&&i.provider===e&&i.message&&i.message===x&&(y.debug("  handshook..."),window.removeEventListener("message",t),clearTimeout(r),n())};window.addEventListener("message",o),s(L)}))};return{provider:function(){return e},state:function(){return n},init:function(o){return new Promise((function(a,s){if(y.info("Gyro.child","init(), Called."),n!==u.READY)throw new Error("library has already been initialized.");n=u.INITING,e=o;var c=function(e){y.debug("Gyro.child","__inited"),n=e||(r.desktop()?u.INACTIVE:u.IDLE),a()};i.isIFramed?(y.debug("Gyro.child","  iframed, handshaking..."),l().then((function(){y.debug("Gyro.child","handshake().then..."),c()})).catch((function(e){y.debug("Gyro.child","handshake().catch..."),c(u.INACTIVE)}))):(y.debug("Gyro.child","  not iframed..."),i.isIOS13||(y.debug("Gyro.child","  doesn't need permissions..."),c()),y.debug("Gyro.child","  needs permissions..."),n=u.REQUESTING,t().then((function(){y.debug("Gyro.child","_requestChild().then..."),c()})))}))},enable:function(){return new Promise((function(r,c){switch(y.info("Gyro.child","enable(), _state:",n),n){case u.INACTIVE:c({error:a.NO_GYRO});break;case u.INITING:c({error:a.INITIALIZING});break;case u.REQUESTING:c({error:a.REQUESTING});break;case u.ENABLING:c({error:a.ENABLING});break;case u.ENABLED:r();break;case u.IDLE:if(y.debug("Gyro.child","  can be enabled..."),i.isIFramed){y.debug("Gyro.child","  iframed...");y.debug("Gyro.child","  adding 'enabled' listener..."),window.addEventListener("message",(function t(o){var i=o.data;y.debug("Gyro.child","__onMessage_enabled__(), payload:",i),i&&i.provider===e&&i.message&&(i.message===j||i.message===O)&&(i.message===j&&(y.debug("Gyro.child","  ERROR:",i.data.error),n=u.INACTIVE),i.message===O&&(y.debug("Gyro.child","  adding 'motion' listener..."),window.addEventListener("message",d),n=u.ENABLED),y.debug("Gyro.child","  removing 'enabled' listener..."),window.removeEventListener("message",t),y.debug("Gyro.child","  _state:",n),r())})),s(R)}else y.debug("Gyro.child","  not iframed..."),i.hasPermissions?(y.debug("Gyro.child","  has permissions...."),y.debug("Gyro.child","  permissionStatus:",i.permissionStatus),t().then((function(){y.info("Gyro.child","_requestChild().then..."),y.debug("Gyro.child","  permssionStatus:",i.permissionStatus),n=i.permissionStatus===o.GRANTED?u.ENABLED:u.INACTIVE,y.debug("Gyro.child","  _state:",n),r()}))):(y.debug("Gyro.child","  no permissions, nothing to do..."),n=u.ENABLED,r())}}))},disable:function(){return new Promise((function(t,r){switch(y.info("Gyro.child","disable(), _state:",n),n){case u.INACTIVE:r({error:a.NO_GYRO});break;case u.INITING:r({error:a.INITIALIZING});break;case u.REQUESTING:r({error:a.REQUESTING});break;case u.ENABLING:case u.DISABLING:r({error:a.ENABLING});break;case u.IDLE:t();break;case u.ENABLED:if(y.debug("Gyro.child","  can be disabled..."),i.isIFramed){y.debug("Gyro.child","  iframed...");y.debug("Gyro.child","  adding 'disabled' listener..."),window.addEventListener("message",(function r(o){var i=o.data;y.debug("Gyro.child","__onMessage_processed(), payload:",i),i&&i.provider===e&&i.message&&(i.message===j||i.message===C)&&(y.debug("Gyro.child","  the message is for us..."),i.message===j&&y("  ERROR:",i.data.error),y.debug("Gyro.child","  removing 'disabled' listener..."),window.removeEventListener("message",r),i.message===C&&(y.debug("Gyro.child","  removing 'motion' listener..."),window.removeEventListener("message",d)),n=u.IDLE,y.debug("Gyro.child","  _state:",n),c=!0,t())})),s(_)}else y.debug("Gyro.child","  not iframed..."),n=u.IDLE,y.debug("Gyro.child","  _state:",n),t()}}))}}}(),B={VERSION:"2.1.0",Env:i,PermissionStatuses:o,States:u,Errors:a,child:U,parent:P};window.concat=window.concat||{},window.concat.Gyro=B}();
//# sourceMappingURL=Gyro.min.js.map
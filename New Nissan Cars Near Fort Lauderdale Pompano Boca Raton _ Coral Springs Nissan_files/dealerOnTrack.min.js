"use strict";var DealerOnTrack=function(){function r(){this.ticket="CONPLAT-1644",this.resources="/resources/components/dealerOnTrack/dealerOnTrack.js",this.src="/src/components/dealerOnTrack/dealerOnTrack.ts",this.readme="Global handler for DealerOnTrack.events. Add attributes to elements\n  that should be tracked. The following attributes exist:\n  category (required), action (required), label, value, callBackTrackEvent\n  "}return Object.defineProperty(r,"safeGetAllTrackers",{get:function(){return"undefined"!=typeof ga&&null!==ga&&void 0!==ga&&ga.getAll?ga.getAll():(console.warn("'ga.getAll' is not defined"),null)},enumerable:!1,configurable:!0}),r.initialize=function(e){this.isNoOp=e.IsNoOp,window.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("[data-dealerontrack-type]").forEach(function(e){r.setupEventByType(e)}),console.log("DealerOnTrack Initialized"),document.querySelectorAll(".priceBlockItemButton > a, .priceBlockItemOffer > a, .priceBlockItemInput > a, .priceBlockItemButton > price-details-button > a, .priceBlockItemButton > button, .priceBlockItemInput input-button-price-element.btn").forEach(function(a){a.hasAttribute("data-dealerontrack-type")||a.addEventListener("click",function(e){var t=a.closest("li"),n=null===t?"":t.dataset.dealerontrackPosition,t=null!==a.closest(".srpVehicle, .vehicle-card");r.pricingStackEvent(e,n,t?"SRP":"VDP")})})})},r.setupDynamicElements=function(){document.querySelectorAll("[data-dealerontrack-type]:not([data-dealerontrack-enabled])").forEach(function(e){r.setupEventByType(e)})},r.setupEventByType=function(n){var a=this,e=null!==(s=n.dataset.dealerontrackType)&&void 0!==s?s:"default",r=n.dataset.dealerontrackCategory,t=null!==(s=n.dataset.dealerontrackAction)&&void 0!==s?s:"",l=null!==(s=n.dataset.dealerontrackLabel)&&void 0!==s?s:"",o=null!==(s=n.dataset.dealerontrackValue)&&void 0!==s?s:"",i=null!==(s=n.dataset.dealerontrackItem)&&void 0!==s?s:"",c=n.dataset.dealerontrackCallback,s=n.dataset.dealerontrackTrigger;"true"!==n.dataset.dealerontrackEnabled&&("change"===s?n.addEventListener(s,function(){var e;a.event(r,null!==(e=null!==(e=n.dataset.dealerontrackPosition)&&void 0!==e?e:new TaggingCommandParser(n.dataset.dealerontrackAction).Value)&&void 0!==e?e:"On Click",new TaggingCommandParser(l).Value,o,c)}):"pricingStack"===e?n.addEventListener("click",function(e){a.pricingStackDataAttributesEvent(t,o,r,i,l)}):n.addEventListener("click",function(e){var t;a.event(r,null!==(t=null!==(t=n.dataset.dealerontrackPosition)&&void 0!==t?t:new TaggingCommandParser(n.dataset.dealerontrackAction).Value)&&void 0!==t?t:"On Click",new TaggingCommandParser(l).Value,o,c)}),n.dataset.dealerontrackEnabled="true")},r.event=function(e,t,n,a,r){if(this.isNoOp)r&&r(t);else{var l=!1;r&&setTimeout(function(){l||(l=!0,console.log("DealerOnTrack callBack function on timeout"),r(t))},3e3);var o=0,i=this.safeGetAllTrackers;if(i){if(void 0===n)for(var c=0;c<i.length;c++){var s=i[c];r?(ga(s.get("name")+".send","event",e,t,{hitCallback:function(){o+=1,i.length!=o||l||(l=!0,console.log("DealerOnTrack hitCallback called!"),r(t))}}),console.log("ga send event called!")):ga(s.get("name")+".send","event",e,t)}else if(void 0===a||""===a)for(c=0;c<i.length;c++){s=i[c];r?(ga(s.get("name")+".send","event",e,t,n,{hitCallback:function(){o+=1,i.length!=o||l||(l=!0,console.log("DealerOnTrack hitCallback called!"),r(t))}}),console.log("ga send event called!")):ga(s.get("name")+".send","event",e,t,n)}else for(c=0;c<i.length;c++){s=i[c];r?(ga(s.get("name")+".send","event",e,t,n,a,{hitCallback:function(){o+=1,i.length!=o||l||(l=!0,console.log("DealerOnTrack hitCallback called!"),r(t))}}),console.log("DealerOnTrack ga send event called!")):ga(s.get("name")+".send","event",e,t,n,a)}console.log("Fired DealerOnTrack.event("+e+", "+t+", "+n+", "+a+", "+r+")")}}},r.pricingStackEvent=function(e,t,n){var a,r;this.isNoOp||(a=t||window.location.href,t="LinkButton"===(r=e.target||e.currentTarget||e.toElement).dataset.elementtype&&r.classList.contains("callNowClass"),e="_blank"===r.target?"Open in new Tab - ":"",r=r.innerText||r.title||r.alt,this.event(t?"Click-to-Call":"VDP/SRP Buttons",a,n+" - "+e+(t?"Call for Details":r)))},r.pricingStackDataAttributesEvent=function(e,t,n,a,r){this.isNoOp||(e=e||window.location.href,this.event(n,e,t+" - "+a+" - "+r))},r.isNoOp=!1,r}(),TaggingCommand=function(){function e(e){this.supportedCommands=["selector","script","literal"],this.supportedScripts=["geturl"],this.parseCommand(e)}return e.prototype.parseCommand=function(e){var t=e.split("::");this.command=t[0],1<t.length&&(e=t[1].split(","),this.primaryInstruction=e[0],1<e.length&&(this.secondaryInstruction=e[1])),2<t.length&&(t=t[2].split(","),this.defaultInstruction=t[0],1<t.length&&(this.defaultSecondaryInstruction=t[1]))},Object.defineProperty(e.prototype,"IsValid",{get:function(){return!(!this.command||!this.primaryInstruction)&&(!("script"==this.command&&!this.supportedScripts.includes(this.primaryInstruction))&&this.supportedCommands.includes(this.command))},enumerable:!1,configurable:!0}),e}(),TaggingCommandParser=function(){function e(e){this.commands=[],this.isParsable=!1,this.item=e,this.parseCommands(e)}return e.prototype.parseCommands=function(e){var t=this;e.split("|").forEach(function(e){e=new TaggingCommand(e);e.IsValid&&t.commands.push(e)}),0<this.commands.length&&(this.isParsable=!0)},Object.defineProperty(e.prototype,"Value",{get:function(){var n=this;if(!this.isParsable)return this.item;var a="";return this.commands.forEach(function(e){switch(e.command){case"selector":var t=n.getElementValue(e.primaryInstruction,e.secondaryInstruction);!t&&e.defaultInstruction&&(t=n.getElementValue(e.defaultInstruction,e.defaultSecondaryInstruction)),a+=t;break;case"literal":a+=e.primaryInstruction;break;case"geturl":a+=window.location.href}}),a||this.item},enumerable:!1,configurable:!0}),e.prototype.getElementValue=function(e,a){var r=this,e=document.querySelectorAll(e),l=[];return e.forEach(function(e){var t,n;a?t=null!=a&&a.startsWith("data-")?null==e?void 0:e.getAttribute(a):r.getElementValue(a):e instanceof HTMLSelectElement?(n=null===(n=e[e.selectedIndex])||void 0===n?void 0:n.innerText)&&(t=n):t=null!==(n=null!==(n=e.value)&&void 0!==n?n:e.textContent)&&void 0!==n?n:e.innerText,t&&l.push(t.replace(/[\n\r]+/g,"").trim())}),0==l.length?"":l.join(",")},e}();try{module.exports={TaggingCommand:TaggingCommand,TaggingCommandParser:TaggingCommandParser}}catch(e){console.warn("module is not defined")}